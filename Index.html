<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>D·∫±n m·∫∑t Th·∫Øng moi</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f0f2f5;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
    }

    header {
      background-color: #0084ff;
      color: white;
      padding: 12px;
      text-align: center;
      font-weight: 600;
      font-size: 18px;
      flex-shrink: 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    #chat {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
      display: flex;
      flex-direction: column-reverse;
      background: #e5ddd5;
      min-height: 0;
      max-height: calc(100vh - 60px);
      height: auto;
    }

    .message {
      max-width: 75%;
      margin-bottom: 12px;
      padding: 0;
      border-radius: 18px;
      position: relative;
      display: flex;
      align-items: flex-start;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { transform: translateY(10px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .message-content {
      padding: 8px 12px;
      border-radius: 18px;
      display: inline-block;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    .user {
      background-color: #0084ff;
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .bot {
      background-color: #fff;
      color: #333;
      align-self: flex-start;
      border-bottom-left-radius: 4px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      margin-right: 8px;
      margin-top: 2px;
      flex-shrink: 0;
    }

    .message.bot .message-content {
      font-size: 15px;
      line-height: 1.4;
    }

    .message.user .message-content {
      font-size: 15px;
      line-height: 1.4;
    }

    #input-area {
      display: flex;
      align-items: center;
      border-top: 1px solid #ddd;
      padding: 8px;
      background: #fff;
      flex-shrink: 0;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 10;
      box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.05);
    }

    #message-input {
      flex: 1;
      padding: 10px 16px;
      border-radius: 20px;
      border: 1px solid #ddd;
      outline: none;
      font-size: 15px;
      background: #f5f6f5;
      transition: border-color 0.2s ease;
    }

    #message-input:focus {
      border-color: #0084ff;
    }

    #send-button {
      background-color: #0084ff;
      color: white;
      border: none;
      border-radius: 20px;
      padding: 10px 16px;
      margin-left: 8px;
      font-size: 15px;
      font-weight: 500;
      transition: background-color 0.2s ease, transform 0.1s ease;
    }

    #send-button:hover {
      background-color: #0073e6;
    }

    #send-button:active {
      transform: scale(0.95);
    }
  </style>
</head>
<body>
  <header>Chat v·ªõi Chatbot</header>
  <div id="chat"></div>
  <div id="input-area">
    <input type="text" id="message-input" placeholder="Nh·∫≠p tin nh·∫Øn..." />
    <button id="send-button">G·ª≠i</button>
  </div>

  <script>
    // L·∫•y c√°c ph·∫ßn t·ª≠ DOM
    const chat = document.getElementById("chat");
    const input = document.getElementById("message-input");
    const sendBtn = document.getElementById("send-button");
    const inputArea = document.getElementById("input-area");

    // H√†m ƒë·ªãnh d·∫°ng gi·ªù
    function getCurrentTime() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      return `B√¢y gi·ªù l√† ${hours}:${minutes}`;
    }

    // Danh s√°ch c√¢u tr·∫£ l·ªùi
    const responses = {
      "xin ch√†o": "Ch√†o m√†y, coder t∆∞∆°ng lai! üòé",
      "hello": "Hi, tui l√† Bot T√®o, s·∫µn s√†ng h·ªó tr·ª£!",
      "m√†y l√† ai": "Tui l√† Bot T√®o, ƒë∆∞·ª£c Grok t·∫°o ra ƒë·ªÉ d·∫°y m√†y code! üòÑ",
      "game": "Game R·∫Øn sƒÉn m·ªìi m√†y l√†m t·ªõi ƒë√¢u r·ªìi? Khoe tui ƒëi!",
      "code": "Mu·ªën h·ªçc code ti·∫øp h·∫£? H·ªèi tui g√¨ n√†o, tui ch·ªâ t·∫≠n t√¨nh!",
      "g√¢u g√¢u": "Haha, m√†y s·ªßa vui gh√™! Mu·ªën h·ªçc l√†m game kh√¥ng? üòÑ",
      "th·ªùi ti·∫øt": "Tui ch∆∞a c√≥ API th·ªùi ti·∫øt, nh∆∞ng ch·∫Øc h√¥m nay n·∫Øng ƒë·∫πp! üòÑ",
      "r·∫Øn sƒÉn m·ªìi": "Game R·∫Øn sƒÉn m·ªìi c·ªßa m√†y c√≥ h√¨nh ·∫£nh ch∆∞a? Khoe tui ƒëi!",
      "ƒëi·ªÉm cao": "Wow, ƒëi·ªÉm cao qu√°! M√†y l√† coder x·ªãn qu√° r·ªìi ƒë√≥! üòé",
      "t·ªëi nay ƒÉn g√¨": "ƒÇn anh √†? üòò Th·∫ø th√¨ t·ªëi nay anh m·ªùi m√†y ƒëi ƒÉn ph·ªü nha!",
      "y√™u": "Y√™u tui h·∫£? Tui c≈©ng y√™u m√†y, coder d·ªÖ th∆∞∆°ng ∆°i! ‚ù§Ô∏è",
      "bu·ªìn": "Bu·ªìn h·∫£? ƒê·ªÉ tui k·ªÉ chuy·ªán vui cho m√†y nghe nha! üòÑ C√≥ con m√®o n√†o code ƒë∆∞·ª£c kh√¥ng?",
      "m·∫•y gi·ªù": getCurrentTime,
      "gi·ªù": getCurrentTime,
      "default": [
        "H√†i h∆∞·ªõc gh√™! üòÑ G√µ g√¨ tui hi·ªÉu h∆°n ƒëi, nh∆∞ 'game', 'code', hay 't·ªëi nay ƒÉn g√¨'!",
        "M√†y vui t√≠nh th·∫≠t ƒë·∫•y! üòé H·ªèi tui g√¨ ƒëi, tui tr·∫£ l·ªùi li·ªÅn!",
        "Hihi, tui ch∆∞a hi·ªÉu l·∫Øm, m√†y th·ª≠ h·ªèi ki·ªÉu kh√°c xem n√†o! üòä"
      ],
      "th·∫Øng l√† ai": "Th·∫Øng moi l√† th·∫±ng b·∫£o chuy·ªÉn 2 s√™n th√¨ kh√¥ng c√≥ m√† chuy·ªÉn cho ng∆∞·ªùi ta 4 man, anh em g√¨ kh√¥ng bi·∫øt"
    };

    let lastInput = "";

    // H√†m th√™m tin nh·∫Øn
    function addMessage(text, sender) {
      const message = document.createElement("div");
      message.className = "message " + sender;

      const avatarSrc = sender === "bot" ? "https://i.imgur.com/8Km9tLL.png" : "https://i.imgur.com/your-avatar-url.jpg";
      const avatar = document.createElement("img");
      avatar.src = avatarSrc;
      avatar.className = "avatar";
      message.appendChild(avatar);

      const content = document.createElement("div");
      content.className = "message-content";
      content.textContent = text;
      message.appendChild(content);

      chat.insertBefore(message, chat.firstChild);
      chat.scrollTop = 0;

      adjustChatHeight();
    }

    // H√†m ƒëi·ªÅu ch·ªânh chi·ªÅu cao khung chat
    function adjustChatHeight() {
      const headerHeight = document.querySelector("header").offsetHeight;
      const inputAreaHeight = inputArea.offsetHeight;
      const maxChatHeight = window.innerHeight - headerHeight - inputAreaHeight;

      chat.style.maxHeight = `${maxChatHeight}px`;
      chat.style.height = "auto";
      if (chat.scrollHeight > maxChatHeight) {
        chat.style.height = `${maxChatHeight}px`;
      }
      chat.scrollTop = 0;
    }

    // H√†m ƒëi·ªÅu ch·ªânh chi·ªÅu cao ƒë·ªông khi b√†n ph√≠m ·∫£o xu·∫•t hi·ªán
    function adjustLayout() {
      const windowHeight = window.innerHeight;
      const inputAreaHeight = inputArea.offsetHeight;
      const headerHeight = document.querySelector("header").offsetHeight;
      const maxChatHeight = windowHeight - headerHeight - inputAreaHeight;

      chat.style.maxHeight = `${maxChatHeight}px`;
      chat.style.paddingBottom = `${inputAreaHeight}px`;
      adjustChatHeight();

      setTimeout(() => {
        inputArea.scrollIntoView({ behavior: "smooth", block: "end" });
      }, 100);
    }

    // G·ªçi h√†m ƒëi·ªÅu ch·ªânh ngay khi t·∫£i trang
    adjustLayout();

    // L·∫Øng nghe s·ª± ki·ªán resize
    window.addEventListener("resize", adjustLayout);

    // X·ª≠ l√Ω khi input ƒë∆∞·ª£c focus
    input.addEventListener("focus", () => {
      setTimeout(() => {
        adjustLayout();
        inputArea.scrollIntoView({ behavior: "smooth", block: "end" });
      }, 700);
    });

    // X·ª≠ l√Ω khi input m·∫•t focus
    input.addEventListener("blur", () => {
      adjustLayout();
    });

    // X·ª≠ l√Ω s·ª± ki·ªán g·ª≠i tin nh·∫Øn
    sendBtn.onclick = () => {
      const text = input.value.trim();
      if (text) {
        addMessage(text, "user");

        let reply = responses["default"];
        for (let key in responses) {
          if (key !== "default" && text.toLowerCase().includes(key)) {
            reply = responses[key];
            if (typeof reply === "function") {
              reply = reply();
            }
            break;
          }
        }
        if (Array.isArray(reply)) {
          reply = reply[Math.floor(Math.random() * reply.length)];
        }
        if (text.toLowerCase().includes("l·∫°i ƒëi") && lastInput.includes("game")) {
          reply = "Haha, v·∫´n khoe game √†? ƒêi·ªÉm bao nhi√™u r·ªìi?";
        }

        setTimeout(() => {
          addMessage("Bot ƒëang g√µ...", "bot");
          setTimeout(() => {
            chat.removeChild(chat.firstChild); // X√≥a "Bot ƒëang g√µ..."
            addMessage(reply, "bot");
          }, 500);
        }, 500);
        lastInput = text.toLowerCase();
        input.value = "";
      } else {
        alert("Vui l√≤ng nh·∫≠p tin nh·∫Øn!");
      }
    };

    // G·ª≠i tin nh·∫Øn b·∫±ng ph√≠m Enter
    input.addEventListener("keypress", function (e) {
      if (e.key === 'Enter') sendBtn.click();
    });
  </script>
</body>
</html>